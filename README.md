# Codeflow

> In the programming world, libraries and tools make developers' work easier by helping 
them write their projects more efficiently. A current issue in this field is the complexity of 
workflows written in YAML, which makes their configuration difficult. The goal of this 
project is to develop a web platform that simplifies the workflow creation process by 
offering an intuitive interface, eliminating the need for manual configuration of these files, 
and thus increasing productivity and development efficiency. The methodology adopted 
to address this problem will be the development of a web application with a user-friendly 
and easy-to-understand interface. This application will allow developers to build their own 
customized workflows through a YAML code generator.
> 
> The goal of this project is to develop a platform that mitigates the difficulties and simplifies the creation of YAML files in an intelligent, guided, and explanatory way. The proposal aims to support especially beginner developers by offering a more accessible and user-friendly experience, reducing the learning curve.

***This project was developed as part of the Computer Science undergraduate thesis, with the purpose of obtaining the bachelorâ€™s degree.***

## How it works?

| Keyword                 | Description
|-------------------------|--------------------------------------------------------------------------------------------------------------|
| Flow                    | The YAML generated by Codeflow                                                                               |
| Schema or Flow Schema   | The data structure responsible for defining the structure and the rules of the YAML that will be generated   |

**The interface is available in this repository. Due to development limitations, we chose to present our concept through a website; however, the core of our proposal resides in the YAML generator, not the website itself. For this reason, the projects are hosted in separate repositories to avoid direct association between the web interface and our solution. You can find the project with the logic behind the thesis that creates the YAML generator at [Codeflow - backend](https://github.com/degui1/codeflow-backend)**

>A WebSocket connection is established between the client and the server to enable real-time validation of the flow schema fields. When the client selects a schema, it is loaded into memory and validated using Zod. After that, the server responds with a JSON object containing the flow schema. The client then interprets this structure and dynamically renders fields based on the schema format. For example, if the schema defines an array, the client renders a component for it â€” this applies to all other data types commonly used in YAML files.
>
>The WebSocket handler uses the previously loaded schema to validate all user inputs, enabling real-time field validation. For each update, the client sends a "set-field-data" message containing the input value and the schema path of the field, so the validator can apply all rules associated with that field.
>
>The validator checks whether the inputâ€™s type, subtype, rules, and default values match the schema requirements.
>
>Once all required fields are filled, the client can send a "create-flow" message to generate the flow (YAML) according to all rules defined in the schema. This message verifies whether all mandatory fields were completed and whether all rules â€” including inter-field rules within a group and rules that span across multiple groups â€” are satisfied.
>
>The create-flow step does not revalidate each field individually, since that was already handled through the set-field-data messages. Instead, it validates the relationships between fields and ensures the schemaâ€™s structural rules are met, as described in the schema documentation.
>
>The generated flow (YAML) can then be downloaded, posted, or edited.

### Flow schema

```yaml
name: Workflow de Testes UnitÃ¡rios

groups:
  on_group:
    label: Eventos
    description: Define os eventos que disparam os testes unitÃ¡rios
    fields:
      on:
        label: "Eventos"
        type: list
        itemType: string
        required: true
        help: "Eventos que acionam o workflow (ex: push, pull_request)"
        defaultValues:
          - push
          - pull_request
          - pull_request_target
          - issues
          - issue_comment
          - fork
          - release
          - schedule
          - workflow_dispatch
          - workflow_call
          - repository_dispatch
          - discussion
          - discussion_comment
          - deployment
          - deployment_status
          - workflow_run
          - create
          - delete
          - label
          - milestone
          - project
          - project_card
          - project_column
          - page_build
          - watch
          - membership
          - check_run
          - check_suite
          - commit_comment
          - gollum
          - member
          - public
          - pull_request_review
          - pull_request_review_comment
          - registry_package
          - status
          - team
          - team_add
          - content_reference
          - merge_group
          - projects_v2_item
          - registry_package
          - secret_scanning_alert
          - security_advisory
          - sponsorship
          - repository_import
          - repository_vulnerability_alert
          - deployment_protection_rule
      branches:
        label: "Branches"
        type: list
        itemType: string
        required: false
        help: "Branches nas quais o workflow deve rodar"
        defaultValues:
          - main
          - master
          - feature
          - prod

  jobs_group:
    label: Jobs
    description: Define os jobs de execuÃ§Ã£o dos testes unitÃ¡rios
    repeatable: true
    fields:
      jobs:
        label: "Jobs"
        type: object
        required: true
        nameableKey: true
        fields:
          runs-on:
            label: "Sistema Operacional"
            type: string
            required: true
            help: "Sistema operacional do job (ex: ubuntu-latest)"
            defaultValues:
              - ubuntu-latest
              - ubuntu-24.04
              - ubuntu-22.04
              - ubuntu-20.04
              - windows-latest
              - windows-2022
              - windows-2019
              - macos-latest
              - macos-15
              - macos-14
              - macos-13
              - macos-12
          steps:
            label: "Etapas"
            type: list
            itemType: object
            required: true
            help: "Etapas executadas no job"
            fields:
              name:
                label: "Nome da Etapa"
                type: string
                required: true
                help: "Nome da etapa"
              run:
                label: "Comando"
                type: string
                required: false
                help: "Comando executado na etapa (ex: npm test)"
              uses:
                label: "AÃ§Ã£o ReutilizÃ¡vel"
                type: string
                required: false
                help: "AÃ§Ã£o reutilizÃ¡vel do GitHub (ex: actions/checkout@v3)"
                defaultValues:
                  - actions/checkout@v4
                  - actions/setup-node@v4
                  - actions/setup-python@v5
              with:
                label: "ParÃ¢metros"
                type: object
                required: false
                help: "ParÃ¢metros para a aÃ§Ã£o reutilizÃ¡vel"

  reports_group:
    label: RelatÃ³rios
    description: RelatÃ³rios e cobertura de testes unitÃ¡rios
    fields:
      reports:
        label: "RelatÃ³rios"
        type: list
        itemType: string
        required: false
        help: "Caminhos ou formatos de relatÃ³rios gerados (ex: junit, lcov, cobertura.xml)"
        defaultValues:
          - junit
          - allure
      coverage:
        label: "Cobertura"
        type: string
        required: false
        help: "Caminho ou formato do relatÃ³rio de cobertura de cÃ³digo (ex: coverage/lcov.info)"

rules:
  required-job:
    description: O workflow deve conter ao menos um job
    condition: $count(groups.jobs_group.fields.jobs) > 0
    error: Ã‰ necessÃ¡rio definir ao menos um job de testes unitÃ¡rios

  required-test-step:
    description: Cada job deve possuir ao menos uma etapa que rode os testes unitÃ¡rios
    condition: >
      $exists(groups.jobs_group.fields.jobs.fields.steps.fields.run ~> /.*(jest|mocha|pytest|unittest|test).*/i)
    error:  Cada job precisa conter ao menos uma etapa que execute testes automatizados. Certifique-se de incluir comandos como 'jest', 'mocha', 'pytest', 'unittest' no campo 'run' de algum step.

  required-report:
    description: Ã‰ recomendado que haja ao menos um relatÃ³rio de cobertura
    condition: $count(groups.reports_group.fields.coverage) > 0
    error: Nenhum relatÃ³rio de cobertura foi definido
```

The input validation core of Codeflow is the central component responsible for ensuring the integrity and consistency of the data that composes the YAML file generated by the application. This layer was designed to translate user interactions in the graphical interface into a validated logical structure, ensuring that each input faithfully matches the requirements defined in the flow schema. Its purpose is to prevent syntax errors, omissions, and semantic inconsistencies while providing immediate feedback during the visual construction of the YAML.

>
>The validatorâ€™s logic is based on a recursive and hierarchical structure capable of handling schemas with different levels of depth. Each field is represented as a node that may contain nested subfields, allowing the validation process to traverse the data tree dynamically.
>
>For each input, the system evaluates key properties such as:
>
> - ***Requiredness (required)*** â€“ determines whether the field must be filled before completion;
>
> - ***Type (type)*** â€“ ensures the value matches the expected type (string, list, object, etc.);
>
> - ***Default values*** and restricted lists (defaultValues) â€“ provide valid filling parameters;
>
> - ***Field dependencies*** â€“ validated both locally (within a group) and globally (across groups).
>
>This approach ensures the flexibility needed to represent complex structures such as jobs, steps, and branches, while still maintaining the syntactic and semantic coherence of the resulting YAML file.
>
>Field navigation is performed using paths, which represent the exact location of a field within the flow hierarchy. The responsible method walks through each segment of the path, creating intermediate structures when necessary and placing the value at the correct position within the main object.
>
>To validate these structures and ensure that dependencies and conditions between fields are respected, Codeflow uses *JSONata*, a query and transformation language for JSON data.
>
>With JSONata, validation expressions are applied to the input object, enabling checks such as:
>
>The existence of required fields ($exists(path));
>
>The number of elements in lists ($count(path));
>
>Conditional relationships, such as â€œif field X exists, field Y must be filled.â€
>
>This mechanism makes the process highly scalable, allowing complex rules to be expressed declaratively and executed dynamically, without manually coding each verification.
>
>Fields with the nameableKey property allow users to define custom keys inside lists or objects, which is common in workflows like GitHub Actions jobs.
The system checks whether an entry with the same label already exists, preventing duplicates and ensuring consistency. If the field does not yet exist, a new instance is automatically created with the provided label, preserving the coherence of the YAML hierarchy.
>
>This special handling enables Codeflow to manage dynamic structures without compromising schema integrity, supporting the creation of more complex and customizable workflows.
>
>The validation process is divided into two stages:
>
>Local validation, applied when each field is filled.
This step checks field-specific rules (such as requiredness and type).
>
>Contextual and global validation, executed when the YAML structure is generated from the form fields.
>This step applies broader rules that analyze dependencies between groups â€” for example, requiring that â€œat least one jobâ€ or â€œat least one on eventâ€ is defined.
>
>The expressions for these rules also use JSONata, making the system flexible and independent of fixed schema content.
>
>The design of the validation core follows principles of modularity and isolation, enabling new schemas (such as for Docker, Unit Tests, or End-to-End Tests) to be integrated without modifying the main logic.
>
>The separation between the interface layer, the schema layer, and the validation engine allows Codeflow to evolve in a controlled manner while maintaining compatibility across different workflow contexts.

<br />
<br />
<br />
<br />

# **Codeflow (PT-BR)**

> No mundo da programaÃ§Ã£o, bibliotecas e ferramentas facilitam o trabalho dos desenvolvedores ao ajudar na escrita de seus projetos de forma mais eficiente. Um problema atual nessa Ã¡rea Ã© a complexidade dos workflows escritos em YAML, o que torna sua configuraÃ§Ã£o difÃ­cil. O objetivo deste projeto Ã© desenvolver uma plataforma web que simplifique o processo de criaÃ§Ã£o desses workflows, oferecendo uma interface intuitiva, eliminando a necessidade de configurar esses arquivos manualmente e, assim, aumentando a produtividade e a eficiÃªncia do desenvolvimento.
> A metodologia adotada para solucionar esse problema consiste no desenvolvimento de uma aplicaÃ§Ã£o web com uma interface amigÃ¡vel e de fÃ¡cil compreensÃ£o. Essa aplicaÃ§Ã£o permitirÃ¡ que desenvolvedores construam seus prÃ³prios workflows personalizados por meio de um gerador de cÃ³digo YAML.
>
> O objetivo deste projeto Ã© desenvolver uma plataforma que reduza as dificuldades e simplifique a criaÃ§Ã£o de arquivos YAML de maneira inteligente, guiada e explicativa. A proposta busca apoiar especialmente desenvolvedores iniciantes, oferecendo uma experiÃªncia mais acessÃ­vel e intuitiva, diminuindo a curva de aprendizado.

***Este projeto foi desenvolvido como parte da monografia de graduaÃ§Ã£o em CiÃªncia da ComputaÃ§Ã£o, com o propÃ³sito de obtenÃ§Ã£o do grau de bacharel.***

---

## **Como funciona?**

| Palavra-chave                 | DescriÃ§Ã£o                                                                                    |
| ----------------------------- | -------------------------------------------------------------------------------------------- |
| **Flow**                      | O YAML gerado pelo Codeflow                                                                  |
| **Schema** ou **Flow Schema** | A estrutura de dados responsÃ¡vel por definir a estrutura e as regras do YAML que serÃ¡ gerado |

**A interface estÃ¡ disponÃ­vel em [Codeflow (Front-end)](https://github.com/degui1/codeflow).
Por limitaÃ§Ãµes de desenvolvimento, optamos por apresentar nosso conceito por meio de um site; contudo, o nÃºcleo da proposta estÃ¡ no gerador de YAML, e nÃ£o no site em si. Por esse motivo, os projetos estÃ£o em repositÃ³rios separados, para evitar a associaÃ§Ã£o direta entre a interface web e a soluÃ§Ã£o.**

> Uma conexÃ£o WebSocket Ã© estabelecida entre o cliente e o servidor para permitir validaÃ§Ã£o em tempo real dos campos do schema do flow. Quando o cliente seleciona um schema, ele Ã© carregado em memÃ³ria e validado utilizando Zod. Em seguida, o servidor responde com um objeto JSON contendo o flow schema. O cliente entÃ£o interpreta essa estrutura e renderiza dinamicamente os campos de acordo com o formato do schema. Por exemplo: caso o schema defina uma lista, o cliente renderiza um componente correspondente â€” isso se aplica a todos os tipos de dados usados em YAML.
>
> O WebSocket handler usa o schema previamente carregado para validar todas as entradas do usuÃ¡rio, permitindo validaÃ§Ã£o em tempo real. A cada atualizaÃ§Ã£o, o cliente envia uma mensagem â€œset-field-dataâ€ contendo o valor inserido e o caminho do campo no schema, para que o validador aplique todas as regras associadas ao campo.
>
> O validador verifica se o tipo, subtipo, regras e valores padrÃ£o da entrada estÃ£o de acordo com o esperado pelo schema.
>
> Quando todos os campos obrigatÃ³rios sÃ£o preenchidos, o cliente pode enviar a mensagem â€œcreate-flowâ€, responsÃ¡vel por gerar o YAML de acordo com todas as regras definidas no schema. Essa etapa garante que todos os campos obrigatÃ³rios foram preenchidos e que todas as regras â€” incluindo relacionamentos entre campos dentro de um grupo ou entre grupos â€” sejam respeitadas.
>
> A etapa de â€œcreate-flowâ€ nÃ£o revalida cada campo individualmente, pois isso jÃ¡ foi feito pelas mensagens â€œset-field-dataâ€. Ela apenas valida relaÃ§Ãµes estruturais e interdependÃªncias descritas na documentaÃ§Ã£o do schema.
>
> O flow (YAML) gerado pode entÃ£o ser baixado, postado ou editado.

## **Flow schema**

```yaml
name: Workflow de Testes UnitÃ¡rios

groups:
  on_group:
    label: Eventos
    description: Define os eventos que disparam os testes unitÃ¡rios
    fields:
      on:
        label: "Eventos"
        type: list
        itemType: string
        required: true
        help: "Eventos que acionam o workflow (ex: push, pull_request)"
        defaultValues:
          - push
          - pull_request
          - pull_request_target
          - issues
          - issue_comment
          - fork
          - release
          - schedule
          - workflow_dispatch
          - workflow_call
          - repository_dispatch
          - discussion
          - discussion_comment
          - deployment
          - deployment_status
          - workflow_run
          - create
          - delete
          - label
          - milestone
          - project
          - project_card
          - project_column
          - page_build
          - watch
          - membership
          - check_run
          - check_suite
          - commit_comment
          - gollum
          - member
          - public
          - pull_request_review
          - pull_request_review_comment
          - registry_package
          - status
          - team
          - team_add
          - content_reference
          - merge_group
          - projects_v2_item
          - registry_package
          - secret_scanning_alert
          - security_advisory
          - sponsorship
          - repository_import
          - repository_vulnerability_alert
          - deployment_protection_rule
      branches:
        label: "Branches"
        type: list
        itemType: string
        required: false
        help: "Branches nas quais o workflow deve rodar"
        defaultValues:
          - main
          - master
          - feature
          - prod

  jobs_group:
    label: Jobs
    description: Define os jobs de execuÃ§Ã£o dos testes unitÃ¡rios
    repeatable: true
    fields:
      jobs:
        label: "Jobs"
        type: object
        required: true
        nameableKey: true
        fields:
          runs-on:
            label: "Sistema Operacional"
            type: string
            required: true
            help: "Sistema operacional do job (ex: ubuntu-latest)"
            defaultValues:
              - ubuntu-latest
              - ubuntu-24.04
              - ubuntu-22.04
              - ubuntu-20.04
              - windows-latest
              - windows-2022
              - windows-2019
              - macos-latest
              - macos-15
              - macos-14
              - macos-13
              - macos-12
          steps:
            label: "Etapas"
            type: list
            itemType: object
            required: true
            help: "Etapas executadas no job"
            fields:
              name:
                label: "Nome da Etapa"
                type: string
                required: true
                help: "Nome da etapa"
              run:
                label: "Comando"
                type: string
                required: false
                help: "Comando executado na etapa (ex: npm test)"
              uses:
                label: "AÃ§Ã£o ReutilizÃ¡vel"
                type: string
                required: false
                help: "AÃ§Ã£o reutilizÃ¡vel do GitHub (ex: actions/checkout@v3)"
                defaultValues:
                  - actions/checkout@v4
                  - actions/setup-node@v4
                  - actions/setup-python@v5
              with:
                label: "ParÃ¢metros"
                type: object
                required: false
                help: "ParÃ¢metros para a aÃ§Ã£o reutilizÃ¡vel"

  reports_group:
    label: RelatÃ³rios
    description: RelatÃ³rios e cobertura de testes unitÃ¡rios
    fields:
      reports:
        label: "RelatÃ³rios"
        type: list
        itemType: string
        required: false
        help: "Caminhos ou formatos de relatÃ³rios gerados (ex: junit, lcov, cobertura.xml)"
        defaultValues:
          - junit
          - allure
      coverage:
        label: "Cobertura"
        type: string
        required: false
        help: "Caminho ou formato do relatÃ³rio de cobertura de cÃ³digo (ex: coverage/lcov.info)"

rules:
  required-job:
    description: O workflow deve conter ao menos um job
    condition: $count(groups.jobs_group.fields.jobs) > 0
    error: Ã‰ necessÃ¡rio definir ao menos um job de testes unitÃ¡rios

  required-test-step:
    description: Cada job deve possuir ao menos uma etapa que rode os testes unitÃ¡rios
    condition: >
      $exists(groups.jobs_group.fields.jobs.fields.steps.fields.run ~> /.*(jest|mocha|pytest|unittest|test).*/i)
    error:  Cada job precisa conter ao menos uma etapa que execute testes automatizados. Certifique-se de incluir comandos como 'jest', 'mocha', 'pytest', 'unittest' no campo 'run' de algum step.

  required-report:
    description: Ã‰ recomendado que haja ao menos um relatÃ³rio de cobertura
    condition: $count(groups.reports_group.fields.coverage) > 0
    error: Nenhum relatÃ³rio de cobertura foi definido
```

## **NÃºcleo de ValidaÃ§Ã£o**

O nÃºcleo de validaÃ§Ã£o do Codeflow Ã© o componente central responsÃ¡vel por garantir a integridade e consistÃªncia dos dados que compÃµem o arquivo YAML gerado pela aplicaÃ§Ã£o. Essa camada foi projetada para traduzir interaÃ§Ãµes do usuÃ¡rio na interface grÃ¡fica em uma estrutura lÃ³gica validada, assegurando que cada entrada corresponda fielmente Ã s exigÃªncias definidas no flow schema. Seu propÃ³sito Ã© evitar erros de sintaxe, omissÃµes e inconsistÃªncias semÃ¢nticas, alÃ©m de oferecer feedback imediato durante a construÃ§Ã£o visual do YAML.

> A lÃ³gica do validador Ã© baseada em uma estrutura recursiva e hierÃ¡rquica capaz de lidar com schemas em diferentes nÃ­veis de profundidade. Cada campo Ã© representado como um nÃ³ que pode conter subcampos aninhados, permitindo que o processo de validaÃ§Ã£o percorra dinamicamente toda a Ã¡rvore de dados.
>
> Para cada entrada, o sistema avalia propriedades como:
>
> * **Obrigatoriedade (required)** â€“ define se o campo deve ser preenchido antes da conclusÃ£o;
> * **Tipo (type)** â€“ garante que o valor corresponda ao tipo esperado (string, list, object etc.);
> * **Valores padrÃ£o** ou listas restritas (**defaultValues**) â€“ oferecem parÃ¢metros vÃ¡lidos de preenchimento;
> * **DependÃªncias entre campos** â€“ validadas localmente (no grupo) e globalmente (entre grupos).
>
> Essa abordagem assegura a flexibilidade necessÃ¡ria para representar estruturas complexas como jobs, steps e branches, mantendo a coerÃªncia sintÃ¡tica e semÃ¢ntica do YAML resultante.
>
> A navegaÃ§Ã£o entre campos Ã© feita por meio de *paths*, que representam a localizaÃ§Ã£o exata de um campo dentro da hierarquia do flow. O mÃ©todo responsÃ¡vel percorre cada segmento do caminho, criando estruturas intermediÃ¡rias quando necessÃ¡rio e posicionando o valor no lugar correto dentro do objeto principal.
>
> Para validar essas estruturas e garantir que dependÃªncias e condiÃ§Ãµes sejam respeitadas, o Codeflow utiliza **JSONata**, uma linguagem de consulta e transformaÃ§Ã£o para dados JSON.
>
> Com JSONata, expressÃµes de validaÃ§Ã£o sÃ£o aplicadas ao objeto de entrada, permitindo verificaÃ§Ãµes como:
>
> * ExistÃªncia de campos obrigatÃ³rios (`$exists(path)`);
> * Quantidade de elementos em listas (`$count(path)`);
> * Regras condicionais entre campos.
>
> Esse mecanismo torna o processo altamente escalÃ¡vel, permitindo que regras complexas sejam expressas de forma declarativa.
>
> Campos com a propriedade *nameableKey* permitem que o usuÃ¡rio defina chaves personalizadas, algo comum em workflows como os jobs do GitHub Actions. O sistema verifica duplicidades e cria instÃ¢ncias automaticamente quando necessÃ¡rio.
>
> A validaÃ§Ã£o funciona em duas etapas:
>
> 1. **ValidaÃ§Ã£o local** â€” executada durante o preenchimento dos campos.
> 2. **ValidaÃ§Ã£o contextual e global** â€” executada ao gerar o YAML.
>
> As expressÃµes dessas regras tambÃ©m utilizam JSONata, tornando o sistema flexÃ­vel e independente do conteÃºdo especÃ­fico do schema.
>
> A arquitetura do nÃºcleo de validaÃ§Ã£o segue princÃ­pios de modularidade e isolamento, permitindo integrar novos schemas (como Docker, Testes UnitÃ¡rios, Testes E2E) sem alterar a lÃ³gica principal.

## ğŸ“‹ Environment Variables

* **VITE_API_BASE_URL**: URL to the [Codeflow backend](https://github.com/degui1/codeflow-backend)

## ğŸ“‹ Development Scripts

```bash
## Runs the server in development mode.
pnpm dev
```

## ğŸ’» Screenshots

### Home
<img width="2560" height="4202" alt="image" src="https://github.com/user-attachments/assets/e00006b6-ab37-4f1f-b31f-c366b8de3f88" />

### Builder
<img width="2560" height="1305" alt="image" src="https://github.com/user-attachments/assets/d3ff5a00-3ed3-44a8-bdac-01e4c0b66525" />

### Profile
<img width="2560" height="1305" alt="image" src="https://github.com/user-attachments/assets/95269c42-9300-4226-a4d6-b52e7aa9be08" />

### Community
<img width="2560" height="1305" alt="image" src="https://github.com/user-attachments/assets/e822b668-4394-48db-bc28-0ed08061049f" />



